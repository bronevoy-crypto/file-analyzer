#!/usr/bin/env python3
"""
–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä —Ñ–∞–π–ª–æ–≤ —Å —Ç–µ–≥–∞–º–∏ (MVP + MVC)
"""

import sys
import os

# –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç—å –∫ –º–æ–¥—É–ª—è–º
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

from controller.main_controller import MainController


def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    print("üöÄ –ó–∞–ø—É—Å–∫ MVP –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤ —Å MVC –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π...")
    
    try:
        # –°–æ–∑–¥–∞–µ–º –∏ –∑–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
        controller = MainController()
        success = controller.run()
        
        if success:
            print("\n" + "üéØ" * 25)
            print("üéØ MVP –ì–û–¢–û–í! –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ MVC —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞.")
            print("üéØ" * 25)
            print("\n–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:")
            print("  1. ‚úÖ MVC –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Model-View-Controller)")
            print("  2. ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–≥–æ–≤ –∏–∑ –∏–º–µ–Ω–∏ –∏ –ø—É—Ç–∏ (Issue #1)")
            print("  3. ‚úÖ –ó–∞–ø–∏—Å—å —Ç–µ–≥–æ–≤ –≤ Excel (–∫–æ–ª–æ–Ω–∫–∞ + –ª–∏—Å—Ç '–¢–µ–≥–∏')")
            print("  4. ‚úÖ –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º")
            print("\n–ú–æ–∂–Ω–æ —É–ª—É—á—à–∞—Ç—å –¥–∞–ª—å—à–µ!")
            
            # –ñ–¥–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
            input("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")
        else:
            print("\n‚ùå –ó–∞–≤–µ—Ä—à–µ–Ω–æ —Å –æ—à–∏–±–∫–∞–º–∏")
            input("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")
            
    except KeyboardInterrupt:
        print("\n\n‚ö†Ô∏è –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–µ—Ä–≤–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
    except Exception as e:
        print(f"\nüî• –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}")
        import traceback
        traceback.print_exc()
        input("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")


if __name__ == "__main__":
    main()